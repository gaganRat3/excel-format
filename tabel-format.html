<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Excel to Borderless Table Formatter</title>
    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue",
          sans-serif;
        background-color: #f4f7f9;
        color: #333;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 20px;
      }
      .container {
        width: 95%;
        max-width: 1000px;
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      }
      h1 {
        text-align: center;
        color: #2c3e50;
      }
      textarea,
      pre {
        width: 100%;
        box-sizing: border-box;
        padding: 15px;
        border: 1px solid #ccc;
        border-radius: 8px;
        font-family: "Courier New", Courier, monospace;
        font-size: 14px;
        white-space: pre;
        overflow-x: auto;
      }
      textarea {
        min-height: 180px;
      }
      pre {
        min-height: 250px;
        background-color: #fdfdfd;
      }
      button {
        display: block;
        width: 100%;
        padding: 15px;
        margin: 20px 0 0 0;
        border: none;
        border-radius: 8px;
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }
      #formatButton {
        background-color: #3498db;
        color: white;
      }
      #formatButton:hover {
        background-color: #2980b9;
      }
      #copyButton {
        background-color: #27ae60;
        color: white;
        margin-top: 10px;
      }
      #copyButton:hover {
        background-color: #229954;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Excel to Borderless Table Formatter üìù</h1>

      <h2>1. Paste Your Excel Data Here</h2>
      <textarea
        id="inputText"
        placeholder="Paste your table data from Excel here..."
      ></textarea>

      <button id="formatButton" onclick="formatTable()">
        ‚ú® Format My Table ‚ú®
      </button>

      <h2>2. Your Aligned Borderless Table</h2>
      <pre id="outputText"></pre>

      <button id="copyButton" onclick="copyOutput()">
        Copy to Clipboard üìã
      </button>
    </div>

    <script>
      function formatTable() {
        const rawText = document.getElementById("inputText").value;
        const outputArea = document.getElementById("outputText");

        if (!rawText.trim()) {
          outputArea.textContent =
            "Input is empty. Please paste your Excel data.";
          return;
        }

        // 1. Split data into rows and cells
        const rows = rawText
          .trim()
          .split("\n")
          .map((row) => row.split("\t"));

        // 2. Calculate the maximum width for each column (this is unchanged)
        const colWidths = rows[0].map((_, colIndex) => {
          let maxWidth = 0;
          rows.forEach((row) => {
            const cellLength = row[colIndex] ? row[colIndex].length : 0;
            if (cellLength > maxWidth) {
              maxWidth = cellLength;
            }
          });
          return maxWidth;
        });

        // --- THIS IS THE MODIFIED PART ---
        // 3. Build the final string without any border characters
        const outputLines = rows.map((row) => {
          const paddedCells = row.map((cell, colIndex) => {
            // Pad each cell with spaces to match the calculated column width
            return (cell || "").padEnd(colWidths[colIndex]);
          });
          // Join the padded cells with a few spaces to create a gap
          return paddedCells.join("   ");
        });

        // 4. Join all the final lines with a newline and display the result
        outputArea.textContent = outputLines.join("\n");
      }

      function copyOutput() {
        const outputArea = document.getElementById("outputText");
        const textToCopy = outputArea.textContent;

        if (
          textToCopy &&
          textToCopy !== "Input is empty. Please paste your Excel data."
        ) {
          navigator.clipboard
            .writeText(textToCopy)
            .then(() => {
              alert("Table copied to clipboard!");
            })
            .catch((err) => {
              console.error("Failed to copy text: ", err);
              alert("Could not copy text. Please try again.");
            });
        } else {
          alert("Nothing to copy yet. Please format a table first.");
        }
      }
    </script>
  </body>
</html>
